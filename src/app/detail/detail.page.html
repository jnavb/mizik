<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>{{ title$ | async }}</ion-title>
    <ion-back-button
      slot="start"
      defaultHref="home"
      [text]="back$ | async"
    ></ion-back-button>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ng-container *ngIf="(result$ | async) as result">
    <ng-container *ngIf="result.data">
      <!-- Main -->
      <ion-card class="card-main">
        <ion-card-header>
          <ion-card-subtitle>{{ result.data.subtitle }}</ion-card-subtitle>
          <ion-card-title>{{ result.data.title | titlecase }}</ion-card-title>
        </ion-card-header>
      </ion-card>

      <!-- Secondary -->
      <ion-row>
        <ion-col *ngIf="result.data.img as img" size="6">
          <ion-card
            class="card-profile"
            [ngStyle]="{
              'background-image': 'url(/assets/characters/' + img + ')'
            }"
          >
          </ion-card>
        </ion-col>
        <ion-col [size]="result.data.img ? 6 : 12">
          <ion-card>
            <ion-card-header>
              <ng-container *ngFor="let info of result.data.info">
                <ion-card-subtitle> {{ info.label }} </ion-card-subtitle>
                <ion-card-subtitle
                  color="dark"
                  style="text-transform: capitalize"
                >
                  {{ info.value }}
                </ion-card-subtitle>
              </ng-container>
            </ion-card-header>
          </ion-card>
        </ion-col>
      </ion-row>

      <!-- Secondary Card -->
      <ion-card
        *ngIf="result.data.secondaryCard as secondaryCard"
        class="card-secondary"
      >
        <ion-card-header>
          <span>{{ secondaryCard.value }}</span>
        </ion-card-header>
      </ion-card>

      <!-- Related Cards -->
      <ion-list-header>
        <ion-label>Related</ion-label>
      </ion-list-header>

      <ion-card
        *ngFor="let related of result.data.related"
        class="card-related"
        (click)="onDetail({ id: related.id, entity: related.entity })"
      >
        <ion-card-header>
          <div>
            <ion-card-subtitle
              >{{ related.subtitle | entityTitlecase:related.entity
              }}</ion-card-subtitle
            >
            <ion-card-title
              >{{ related.title | entityTitlecase:related.entity
              }}</ion-card-title
            >
          </div>
          <ion-icon name="chevron-forward-outline"></ion-icon>
        </ion-card-header>
      </ion-card>
      <!-- fab placed to the bottom and start and on the bottom edge of the content overlapping footer with a list to the right -->
      <ion-fab vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button close-icon="heart" color="danger">
          <ion-icon name="heart-outline"></ion-icon>
        </ion-fab-button>
        <ion-fab-list side="top"> </ion-fab-list>
      </ion-fab>
    </ng-container>

    <ng-container *ngIf="result.error">
      <h1>Oopsie, try again later</h1>
    </ng-container>

    <ng-container *ngIf="result.loading">
      <ion-progress-bar type="indeterminate"></ion-progress-bar>
    </ng-container>
  </ng-container>
</ion-content>
